<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->  
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->  
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->  
<head>
    <title>高教区生活助手</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">    
    <link rel="shortcut icon" href="favicon.ico">  
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,300italic,400italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'> 
    <!-- Global CSS -->
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">
    <!-- Plugins CSS -->    
    <link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="assets/plugins/prism/prism.css">
    <!-- Theme CSS -->  
    <link id="theme-style" rel="stylesheet" href="assets/css/styles.css">
    <!-- right-weather -->
    <link rel="stylesheet" type="text/css" href="right-weather.css">
    <link rel="stylesheet" type="text/css" href="assets/css/search-suggestion.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<!--    <script src="assets/js/search-suggestion.js"></script>-->
    <![endif]-->
</head> 

<body data-spy="scroll">
    
    <!-- ******HEADER****** --> 
    <header id="header" class="header">  
        <div class="container">            
            <h1 class="logo pull-left">
                <a class="scrollto" href="#promo">
                    <span class="logo-title">Logo</span>
                </a>
            </h1><!--//logo-->
            <!-- 顶部天气开始 -->
            <div class="gover_search">
                <div class="gover_search_form clearfix">
                    <input type="text" class="input_search_key" id="gover_search_key" placeholder="请输入想去的地点" />
                    <button type="submit" class="btn-sm search_btn">搜索</button>
                    <div class="search_suggest" id="gov_search_suggest">
                        <ul>
                        </ul>
                    </div>
                </div>
            </div>
            <!--
            <div id="right-weather">
                <ul  id="ul-weather">
                    <li>苏州</li>
                    <li id="temperature"></li>
                    <li id="wind"></li>
                </ul>
            </div>-->
            <!-- 顶部天气结束 -->
        </div>
        
    </header><!--//header-->
    
    <!-- ******PROMO****** -->
    <section id="promo" class="promo section offset-header">
        <div class="container text-center">
            <h2 class="title"><span class="highlight">高教区</span>生活助手</h2>
            <p class="intro">简介什么的。。。</p>
			<div class="row">
				<div class="item col-md-3 col-sm-3 col-xs-6">
					<a href="school_update_two.html">
						<img class="imgl"  src="assets/images/school.png" alt="入学" />
					</a>
					<p class="img-lable">入学</p>
				</div>
				<div class="item col-md-3 col-sm-3 col-xs-6">
					<a href="life.html">
						<img class="imgr"  src="assets/images/live-2.png" alt="生活" />
					</a>
					<p class="img-lable">生活</p>
				</div>
				<div class="item col-md-3 col-sm-3 col-xs-6">
                    <a href="bus.html">
						<img class="imgl"  src="assets/images/bus-4.png" alt="公交" />
                    </a>
					<p class="img-lable">公交</p>
				</div>
				<div class="item col-md-3 col-sm-3 col-xs-6">
					<a href="weather.html">
						<img class="imgr"  src="assets/images/weather.png" alt="天气" />
					</a>
					<p class="img-lable">天气</p>
				</div>
			</div>
            <ul class="meta list-inline">
                <!--<li><a href="https://github.com/xriley/devAid-Theme" target="_blank">View on GitHub</a></li>-->
                <!-- <li>联系我们</li>
                <li>站长信箱: 123@a.com</li> -->
            </ul><!--//meta-->
        </div><!--//container-->
    </section><!--//promo-->
    
    <!-- ******ABOUT****** --> 
    <section id="news" class="about section">
        <div class="container">
            <h2 class="title text-center"><a href="news">新闻</a></h2>
            <div class="row">
                <div class="item col-md-4 col-sm-6 col-xs-12">
                    <div class="content">
                        <h3 class="sub-title">标题</h3>
                        <p>新闻内容</p>
                    </div><!--//content-->
                </div><!--//item-->
                <div class="item col-md-4 col-sm-6 col-xs-12">
                    <div class="content">
                        <h3 class="sub-title">标题</h3>
                        <p>新闻内容</p>
                    </div><!--//content-->
                </div><!--//item-->
                <div class="item col-md-4 col-sm-6 col-xs-12">
                    <div class="content">
                        <h3 class="sub-title">标题</h3>
                        <p>新闻内容</p>
                    </div><!--//content-->
                </div><!--//item--> 
                <div class="item col-md-4 col-sm-6 col-xs-12">
                    <div class="content">
                        <h3 class="sub-title">标题</h3>
                        <p>新闻内容</p>
                    </div><!--//content-->
                </div><!--//item-->                
                <div class="item col-md-4 col-sm-6 col-xs-12">
                    <div class="content">
                        <h3 class="sub-title">标题</h3>
                        <p>新闻内容</p>
                    </div><!--//content-->
                </div><!--//item-->
                <div class="item col-md-4 col-sm-6 col-xs-12">
                    <div class="content">
                        <h3 class="sub-title">标题</h3>
                        <p>新闻内容</p>
                    </div><!--//content-->
                </div><!--//item-->              
            </div><!--//row-->            
        </div><!--//container-->
    </section><!--//about-->
    <!-- ******FOOTER****** --> 
    <footer class="footer">
        <div class="container text-center">
            <!--/* This template is released under the Creative Commons Attribution 3.0 License. Please keep the attribution link below when using for your own project. Thank you for your support. :) If you'd like to use the template without the attribution, you can check out other license options via our website: themes.3rdwavemedia.com */-->
            <small class="copyright">站长信箱 ：123@a.com</small>
        </div><!--//container-->
    </footer><!--//footer-->
     
    <!-- Javascript -->          
    <script type="text/javascript" src="assets/plugins/jquery-1.11.3.min.js"></script>   
    <script type="text/javascript" src="assets/plugins/jquery.easing.1.3.js"></script>   
    <script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>     
    <script type="text/javascript" src="assets/plugins/jquery-scrollTo/jquery.scrollTo.min.js"></script> 
    <script type="text/javascript" src="assets/plugins/prism/prism.js"></script>    
    <script type="text/javascript" src="assets/js/main.js"></script>  
    <script type="text/javascript">
        $(document).ready(function(){
/*    		$.ajax({
    			url:"http://api.jirengu.com/weather.php?city=suzhou",
    			async:false,
    			type:"POST",
    			success:function(data){
        			var obj = JSON.parse(data);
        			var weatherData = obj.results[0].weather_data[0];
        			document.getElementById("wind").innerHTML=weatherData.wind;
        			document.getElementById("temperature").innerHTML=weatherData.temperature;
    			}
    		});*/
            $.ajax({
                async:false,
                type:"GET",
                url:'http://dustcenix.site/api/stores.json',
                success:function(obj){//store是API返回的JSON串
                    for(var i=0; i<obj.data.content.length; i++){
                        var storeDetail = obj.data.content[i];

                        var divStore = document.createElement("div");
                        divStore.setAttribute("class", "store");
                        var img = document.createElement("img");
                        img.setAttribute("src",'http://dustcenix.site'+storeDetail.photo );
                        var divDetail = document.createElement("div");
                        divDetail.setAttribute("class", "detail");
                        var p = document.createElement("p");
                        p.setAttribute("class", "curTemp");
                        p.innerHTML = storeDetail.storename;
                        var pAddress = document.createElement("p");
                        pAddress.setAttribute("class", "address");
                        pAddress.setAttribute("onclick","jump(this);");
                        pAddress.innerHTML = "地址:"+storeDetail.address;
                        divDetail.appendChild(p);
                        divDetail.appendChild(pAddress);
                        divStore.appendChild(img);
                        divStore.appendChild(divDetail);
                        document.getElementById("storecon").appendChild(divStore);
                    }},
            });
            hide();
		});
        function hide(){
            $(".loading").fadeOut();
        }

        function jump(obj){
            var url = "goToHere.html?addr="+encodeURI(encodeURI(obj.parentNode.firstChild.innerHTML));
            window.location.href = url;
        }


        //实现搜索输入框的输入提示js类
        function oSearchSuggest(searchFuc){
            var input = $('#gover_search_key');
            var suggestWrap = $('#gov_search_suggest');
            var key = "";
            var init = function(){
                input.bind('keyup',sendKeyWord);
                input.bind('blur',function(){setTimeout(hideSuggest,100);})
            }
            var hideSuggest = function(){
                suggestWrap.hide();
            }

            //发送请求，根据关键字到后台查询
            var sendKeyWord = function(event){

                //键盘选择下拉项
                if(suggestWrap.css('display')=='block'&&event.keyCode == 38||event.keyCode == 40){
                    var current = suggestWrap.find('li.hover');
                    if(event.keyCode == 38){
                        if(current.length>0){
                            var prevLi = current.removeClass('hover').prev();
                            if(prevLi.length>0){
                                prevLi.addClass('hover');
                                input.val(prevLi.html());
                            }
                        }else{
                            var last = suggestWrap.find('li:last');
                            last.addClass('hover');
                            input.val(last.html());
                        }

                    }else if(event.keyCode == 40){
                        if(current.length>0){
                            var nextLi = current.removeClass('hover').next();
                            if(nextLi.length>0){
                                nextLi.addClass('hover');
                                input.val(nextLi.html());
                            }
                        }else{
                            var first = suggestWrap.find('li:first');
                            first.addClass('hover');
                            input.val(first.html());
                        }
                    }

                    //输入字符
                }else{
                    var valText = $.trim(input.val());
                    if(valText ==''||valText==key){
                        return;
                    }
                    searchFuc(valText);
                    key = valText;
                }

            }
            //请求返回后，执行数据展示
            this.dataDisplay = function(data){
                if(data.length<=0){
                    suggestWrap.hide();
                    return;
                }

                //往搜索框下拉建议显示栏中添加条目并显示
                var li;
                var tmpFrag = document.createDocumentFragment();
                suggestWrap.find('ul').html('');
                for(var i=0; i<data.length; i++){
                    li = document.createElement('LI');
                    li.innerHTML = data[i];
                    tmpFrag.appendChild(li);
                }
                suggestWrap.find('ul').append(tmpFrag);
                suggestWrap.show();

                //为下拉选项绑定鼠标事件
                suggestWrap.find('li').hover(function(){
                    suggestWrap.find('li').removeClass('hover');
                    $(this).addClass('hover');

                },function(){
                    $(this).removeClass('hover');
                }).bind('click',function(){
                    input.val(this.innerHTML);
                    suggestWrap.hide();
                });
            }
            init();
        };

        //实例化输入提示的JS,参数为进行查询操作时要调用的函数名
        var searchSuggest =  new oSearchSuggest(sendKeyWordToBack);

        //这是一个模似函数，实现向后台发送ajax查询请求，并返回一个查询结果数据，传递给前台的JS,再由前台JS来展示数据。本函数由程序员进行修改实现查询的请求
        //参数为一个字符串，是搜索输入框中当前的内容
        function sendKeyWordToBack(keyword){
            var obj = {
                "keyword" : keyword
            };
            $.ajax({
                type: "GET",
                url: "http://dustcenix.site/api/getsuggestion.json",
                url: "http://dustcenix.site/api/getsuggestion.json",
                data:{query:keyword,region:"苏州"},
                success: function(data){
                    //var json = eval("("+data+")");
                    var aData = [];
                    for(var i=0;i<data.data.result.length;i++){
                        //以下为根据输入返回搜索结果的模拟效果代码,实际数据由后台返回

                        aData.push(data.data.result[i].name);
                    }
                    //将返回的数据传递给实现搜索输入框的输入提示js类
                    searchSuggest.dataDisplay(aData);
                }
            });
            /*
             //以下为根据输入返回搜索结果的模拟效果代码,实际数据由后台返回
             var aData = [];
             aData.push(keyword+'返回数据1');
             aData.push(keyword+'返回数据2');
             aData.push(keyword+'不是有的人天生吃素的');
             aData.push(keyword+'不是有的人天生吃素的');
             aData.push(keyword+'2012是真的');
             aData.push(keyword+'2012是假的');
             //将返回的数据传递给实现搜索输入框的输入提示js类
             searchSuggest.dataDisplay(aData);*/

        }
    </script>     
</body>
</html> 

